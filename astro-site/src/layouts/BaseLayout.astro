---
import '../styles/global.css';

interface Props {
  title: string;
  /** Optional body class for page-specific styles (e.g. .page-contact) */
  bodyClass?: string;
}

const { title, bodyClass } = Astro.props;
const base = import.meta.env.BASE_URL;
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <slot name="head" />
    <title>{title}</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="preload"
      href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600;700;800&family=Montserrat:wght@400;600;700;800&family=IM+Fell+English:ital@0;1&display=optional"
      as="style"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600;700;800&family=Montserrat:wght@400;600;700;800&family=IM+Fell+English:ital@0;1&display=optional"
      rel="stylesheet"
    />
    <!-- Seal preloaded for above-the-fold logo; GIF not preloaded so 2MB doesn't compete with fonts/layout during initial load -->
    <link rel="preload" href={`${base}images/The Circle of Light Seal - Yellow Transparent.png`} as="image" />
    <script is:inline>
      if ('scrollRestoration' in history) history.scrollRestoration = 'manual';
      function addLoaded() {
        document.documentElement.classList.add('loaded');
        document.body.classList.add('loaded');
      }
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', function () { setTimeout(addLoaded, 150); });
      } else {
        setTimeout(addLoaded, 150);
      }
      window.addEventListener('load', addLoaded);
    </script>
  </head>
  <body class={bodyClass}>
    <style is:global>
      body.loaded::before { background-image: url("{base}images/EOE Tunnel.gif"); }
    </style>
    <div class="page">
      <div class="noise" aria-hidden="true"></div>
      <slot />
    </div>
  </body>
</html>
